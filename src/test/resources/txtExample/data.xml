<config>
    <searches>
        <!-- in this case, we have a CSV (space delimited file) so we define the line once, and then reuse it over
        and again fr each value -->
        <search id="QUERY-LINE"><![CDATA[{ipAddress}\s+{numbers}(\s+\S+){5}\s+({numbersThenText})\s+{status}]]></search>
        <!-- Some rules for finding text, to make the values a little easier below -->
        <search id="numbers"><![CDATA[(\d+)]]></search>
        <search id="numbersThenText"><![CDATA[(\d+\S+)]]></search>
        <search id="stringToEOL"><![CDATA[{string}{EOL}]]></search>
        <search id="string"><![CDATA[(\S+?)]]></search>
        <search id="ipAddress"><![CDATA[(\d+(\.\d+){3})]]></search>
        <search id="status"><![CDATA[((\d+)|(\D.*))]]></search>
        <search id="EOL"><![CDATA[[\n\r]]]></search>
    </searches>
    <!-- There is a record per line -->
    <delim per-line="true" />

    <!--
    This is the last line of the header
     -->
    <header-delim><![CDATA[address\s+Time(s)\s+ax(g)\s+ay(g)\s+az(g)\s+wx(deg/s)\s+wy(deg/s)\s+wz(deg/s)\s+AngleX(deg)\s+AngleY(deg)\s+AngleZ(deg)\s+T(Â°)\s+hx\s+hy\s+hz\s+D0\s+D1\s+D2\s+D3\s+Pressure(Pa)\s+Altitude(m)\s+Lon(deg)\s+Lat(deg)\s+GPSHeight(m)\s+GPSYaw(deg)\s+GPSV(km/h)\s+q0\s+q1\s+q2\s+q3\s+SV\s+PDOP\s+HDOP\s+VDOP]]></header-delim>
    <!--
    This scans the document up to and including the header delim, and then includes these into every record
    These values are included in every record
    -->
    <header>
        <value id="routerId"><![CDATA[BGP router identifier {string},]]></value>
        <value id="localAS"><![CDATA[BGP router identifier \S*?, local AS number {numbers}]]></value>
    </header>
    <values>
        <!-- here we reuse the line pattern, only we pull out different group values -->
        <value id="remoteIp" group="1"><![CDATA[{QUERY-LINE}]]></value>
        <value id="remoteAS" group="3"><![CDATA[{QUERY-LINE}]]></value>
        <value id="uptime" group="5"><![CDATA[{QUERY-LINE}]]></value>
        <value id="status" group="7"><![CDATA[{QUERY-LINE}]]></value>
    </values>
</config>